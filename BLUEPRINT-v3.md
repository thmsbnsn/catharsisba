
# Catharsis — Project Blueprint (Astro + Tailwind + PHP)

A practical map from local edits to a live site on Hostinger. Keep this in the repo root as **BLUEPRINT.md**.

---

## 1) Directory Layout

```
catharsis/
├─ api/
│  └─ lead.php
├─ dist/                         # build output (generated by `npm run build`)
├─ libs/
│  └─ PHPMailer/
│     └─ src/...
├─ public/
│  ├─ fonts/
│  │  ├─ inter-var.woff2
│  │  ├─ inter-var-italic.woff2
│  │  ├─ playfair-display.woff2
│  │  ├─ playfair-display-italic.woff2
│  │  └─ bebas-neue.woff2
│  ├─ icons/
│  │  └─ cba-icons.svg
│  ├─ images/
│  │  ├─ artists/
│  │  │  ├─ austin-stirling/
│  │  │  └─ chris-summers/
│  │  ├─ branding/
│  │  ├─ studio/
│  │  └─ webpages/
│  └─ videos/
├─ src/
│  ├─ components/
│  │  ├─ ArtistGallery.jsx
│  │  ├─ Gallery.jsx
│  │  ├─ Icon.jsx
│  │  ├─ LeadForm.jsx
│  │  ├─ MegaMenu.jsx
│  │  ├─ NavCard.jsx
│  │  └─ OffCanvasNav.jsx
│  ├─ layouts/
│  │  └─ BaseLayout.astro
│  ├─ lib/
│  │  └─ seo.ts
│  ├─ pages/
│  │  ├─ index.astro
│  │  ├─ artists.astro
│  │  ├─ gallery.astro
│  │  ├─ contact.astro
│  │  ├─ sitemap.xml.ts
│  │  └─ artists/[slug].astro
│  ├─ content/
│  │  ├─ config.ts
│  │  └─ artists/
│  │     ├─ austin-stirling.md
│  │     └─ chris-summers.md
│  └─ styles/
│     └─ base.css
├─ .htaccess
├─ astro.config.mjs
├─ package.json
├─ package-lock.json
├─ postcss.config.cjs
├─ tailwind.config.mjs
└─ BLUEPRINT.md
```

---

## 2) Media Naming Rules

- lowercase, hyphen-separated (`a-z 0-9 -`)
- optional subject → person/place → detail → counter
- width suffix for responsive sets: `-1920`, `-1280`, `-768`, `-480`
- two‑digit counters: `-01`, `-02`, …
- examples:
  - `home-hero-1920.avif`
  - `fine-line-sleeve-austin-01-1600.webp`
  - `studio-front-desk-1280.webp`

---

## 3) Images Workflow

**Export sizes**
- Hero: `1920`, `1280`, `768`
- Gallery large: `1600`
- Card/Thumb: `480` (optional `960` for 2×)

**Compress**
- Prefer **AVIF** (quality ~45–55, effort 6–8)
- WebP fallback (quality 70–80)
- Target sizes: hero ≤ 300–500 KB, gallery ≤ 150–250 KB, thumb ≤ 90 KB

**Place**
```
public/images/hero/
public/images/artists/austin-stirling/
public/images/artists/chris-summers/
public/images/studio/
public/images/branding/
public/images/webpages/
```

**Use (example)**
```astro
<picture>
  <source srcset="/images/hero/home-1920.avif 1920w,
                  /images/hero/home-1280.avif 1280w,
                  /images/hero/home-768.avif 768w" type="image/avif" />
  <source srcset="/images/hero/home-1920.webp 1920w,
                  /images/hero/home-1280.webp 1280w,
                  /images/hero/home-768.webp 768w" type="image/webp" />
  <img src="/images/hero/home-1280.webp"
       srcset="/images/hero/home-1920.webp 1920w, /images/hero/home-1280.webp 1280w, /images/hero/home-768.webp 768w"
       sizes="(min-width:1024px) 1280px, 100vw"
       alt="Catharsis homepage hero"
       loading="lazy" decoding="async" width="1280" height="720" />
</picture>
```

---

## 4) Fonts (self‑hosted WOFF2)

**Files (in `public/fonts/`)**
```
inter-var.woff2
inter-var-italic.woff2
playfair-display.woff2
playfair-display-italic.woff2
bebas-neue.woff2
```

**CSS (top of `src/styles/base.css`)**
```css
@font-face{ font-family:"Inter"; src:url("/fonts/inter-var.woff2") format("woff2-variations"); font-weight:100 900; font-style:normal; font-display:swap; }
@font-face{ font-family:"Inter"; src:url("/fonts/inter-var-italic.woff2") format("woff2-variations"); font-weight:100 900; font-style:italic; font-display:swap; }
@font-face{ font-family:"Playfair Display"; src:url("/fonts/playfair-display.woff2") format("woff2-variations"); font-weight:100 900; font-style:normal; font-display:swap; }
@font-face{ font-family:"Playfair Display"; src:url("/fonts/playfair-display-italic.woff2") format("woff2-variations"); font-weight:100 900; font-style:italic; font-display:swap; }
@font-face{ font-family:"Bebas Neue"; src:url("/fonts/bebas-neue.woff2") format("woff2"); font-weight:400; font-style:normal; font-display:swap; }
```

Tailwind families (in `tailwind.config.mjs`):
```js
fontFamily: {
  sans: ['Inter', 'system-ui', 'sans-serif'],
  display: ['Bebas Neue', 'Inter', 'sans-serif'],
  serif: ['Playfair Display', 'serif']
}
```

---

## 5) Development Commands

```bash
npm ci          # install exact dependencies from lockfile
npm run dev     # local preview with hot reload
npm run build   # outputs production site to ./dist
```

If things act weird, delete `.astro/` and re-run `npm ci` then `npm run build`.

---

## 6) Deploy to Hostinger (File Manager)

Upload **four items** to your site folder (root = `public_html/`, or a subfolder):

1. **Contents of `dist/`** (ensure `index.html` is at the folder root)
2. **`api/`** (with `lead.php`)
3. **`libs/PHPMailer/`**
4. **`.htaccess`**

**.htaccess (drop-in)**
```apache
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # Serve existing files/dirs
  RewriteCond %{REQUEST_FILENAME} -f [OR]
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Allow API & PHP through
  RewriteCond %{REQUEST_URI} ^/api/ [OR]
  RewriteCond %{REQUEST_URI} \.php$ [NC]
  RewriteRule ^ - [L]

  # SPA fallback
  RewriteRule ^ index.html [L]
</IfModule>

<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType text/html "access plus 1h"
  ExpiresByType text/css "access plus 1y"
  ExpiresByType application/javascript "access plus 1y"
  ExpiresByType image/webp "access plus 1y"
  ExpiresByType image/avif "access plus 1y"
  ExpiresByType image/svg+xml "access plus 1y"
  ExpiresDefault "access plus 1M"
</IfModule>

<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set Permissions-Policy "interest-cohort=()"
</IfModule>

# (optional) correct MIME types
AddType image/avif avif
AddType image/webp webp
```

**Subfolder deploy** (e.g., `/staging/`)
- Change `RewriteBase /` → `RewriteBase /staging/`
- Frontend calls form at `/staging/api/lead.php`
- Optionally set `base: "/staging/"` in `astro.config.mjs` and rebuild

---

## 7) Lead Form Checklist

- `require` PHPMailer from `../libs/PHPMailer/src/*`
- configure SMTP (host, user, pass, port, encryption)
- sanitize inputs; return JSON or redirect
- test `/api/lead.php` directly after upload

---

## 8) 1‑Minute Smoke Test

- `/` loads; refresh `/artists` (no 404)
- DevTools → Network: fonts and images show 200 OK
- Submit form → success response and email received

---

## 9) Optional: .gitignore

```
node_modules/
.astro/
dist/
.DS_Store
*.log
```

---

## 10) Add a New Artist (content flow)

1. Images → `public/images/artists/<slug>/`
2. Markdown → `src/content/artists/<slug>.md`
3. Route → `src/pages/artists/[slug].astro` renders the content
4. Build & deploy
```

